---
layout: post
category: 関数
title: "by_ref.txt"
---

<small>この文章はAIで生成しています。誤りが含まれることがあります。</small>

このプログラムは、VBA（Visual Basic for Applications）を使用して、文字列を処理するサブルーチン（サブプロシージャ）を定義し、そのサブルーチンを呼び出す方法を示しています。

まず、`Sub f2(ByRef str As String)`という宣言があります。これは、`f2`という名前のサブルーチンを定義しています。このサブルーチンは、`str`という名前の文字列を参照（ByRef）として受け取ります。`ByRef`は、サブルーチン内で変更した文字列が元の変数にも反映されることを意味します。

次に、`'Debug.Print(str)`という行がありますが、これはコメントアウトされています。コメントアウトされているため、この行は実行されませんが、コメントアウトを外すと、`str`の内容をデバッグウィンドウに表示することができます。

`str="hello"`という行は、`str`という変数に文字列"hello"を代入しています。

最後に、`r = f2(str)`という行がありますが、これは`f2`というサブルーチンを呼び出し、`str`を渡しています。`f2`は`str`を変更することはなく、`r`という変数に戻り値が返されますが、このサブルーチンでは戻り値はありません（`r`には何も代入されません）。

このプログラムは、VBAの基本的なサブルーチンの定義と呼び出しを示し、文字列の参照とデバッグ出力の方法を説明しています。

```vb
Sub f2 (ByRef str As String)
  'Debug.Print(str)
End Sub

str="hello"
r = f2(str)
```
