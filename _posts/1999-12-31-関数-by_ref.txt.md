---
layout: post
category: 関数
title: "by_ref.txt"
---

<small>この文章はAIで生成しています。誤りが含まれることがあります。</small>

このプログラムは、文字列 "hello" を変数 `str` に代入し、`f2` という名前のサブルーチンを呼び出します。`f2` サブルーチンは、引数として渡された文字列 `str` の値をコンソールに出力する、非常にシンプルな処理を行います。ただし、`Debug.Print(str)` という行はコメントアウトされており、実際に文字列が出力されることはありません。

`Call f2(str)` によって、`f2` サブルーチンが `str` 変数の値を引数として呼び出されます。`ByRef` キーワードは、`str` が参照渡しで渡されることを意味します。これにより、`f2` サブルーチン内で `str` の値を変更しても、元の `str` 変数の値は変更されません。`f2` サブルーチンは、引数として渡された文字列 `str` のコピーに対してのみ処理を実行します。したがって、`f2` サブルーチンは引数として渡された `str` の値を直接変更できません。

このコードの実行結果は、コンソールに "hello" という文字列が出力されることはありません。これは、`Debug.Print(str)` がコメントアウトされているためです。もしコメントを解除すれば、コンソールに出力されることになります。


```vb
Sub f2 (ByRef str As String)
  'Debug.Print(str)
End Sub

str="hello"
Call f2(str)

```
