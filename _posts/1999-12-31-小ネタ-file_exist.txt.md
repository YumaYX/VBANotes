---
layout: post
category: 小ネタ
title: "file_exist.txt"
---

<small>この文章はAIで生成しています。誤りが含まれることがあります。</small>

このプログラムは、指定されたファイル名が存在するかどうかを確認し、その結果に基づいてメッセージボックスを表示するものです。

まず、`Dim str As String` は、`str`という名前の文字列型の変数を宣言しています。そして、`str = "filename"` は、この文字列変数 `str` に "filename" という文字列を代入しています。この "filename" がファイル名として使用されます。

次に、`If Dir(str) <> "" Then` が重要な部分です。`Dir(str)` 関数は、ファイルシステム上で、指定されたファイル名 (`str` に格納された文字列) を含むファイルが存在するかどうかを調べます。ファイルが存在する場合、`Dir(str)` はファイル名 (パスを含む) を文字列として返します。ファイルが存在しない場合、またはファイル名を検索できなかった場合、`Dir(str)` は空文字列 ("") を返します。

`Dir(str) <> ""` という条件式は、`Dir(str)` の返した文字列が空文字列と *異なる* 場合 (つまり、ファイルが存在する場合) に `True` と評価されます。この `True` の場合に、`Then` ブロック内のコードが実行されます。

`Then` ブロック内では、`MsgBox "有り"` が実行され、"有り" というメッセージが表示されるメッセージボックスが出力されます。これは、ファイル名 "filename" に対応するファイルが存在することを意味します。

`Else` ブロックは、`Dir(str) <> ""` という条件式が `False` と評価された場合に実行されます。つまり、`Dir(str)` が空文字列 ("") を返した場合 (ファイルが存在しない場合) に、`Else` ブロック内のコードが実行されます。

`Else` ブロック内では、`MsgBox "無し"` が実行され、"無し" というメッセージが表示されるメッセージボックスが出力されます。これは、ファイル名 "filename" に対応するファイルが存在しないことを意味します。

最後に、`End If` は、`If` 文の終了を示すキーワードです。これにより、プログラムは `If` 文内の条件に基づいて処理を分岐し、適切なメッセージボックスを表示します。このプログラムは、特定のファイル名が存在するかどうかを効率的にチェックし、結果をユーザーに分かりやすく提示するものです。


```vb
Dim str As String: str = "filename"
If Dir(str) <> "" Then
    MsgBox "有り"
Else
    MsgBox "無し"
End If
```
